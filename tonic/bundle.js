(()=>{var R=Object.create;var _=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var y=(l=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(l,{get:(e,t)=>(typeof require<"u"?require:e)[t]}):l)(function(l){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+l+'" is not supported')});var b=(l,e)=>()=>(e||l((e={exports:{}}).exports,e),e.exports);var E=(l,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of C(e))!v.call(l,r)&&r!==t&&_(l,r,{get:()=>e[r],enumerable:!(n=x(e,r))||n.enumerable});return l};var $=(l,e,t)=>(t=l!=null?R(k(l)):{},E(e||!l||!l.__esModule?_(t,"default",{value:l,enumerable:!0}):t,l));var w=b((N,A)=>{A.exports={name:"@socketsupply/tonic",version:"14.1.5",description:"A component framework.",scripts:{"ci:test:tape-run":"esbuild --bundle test/index.js | tape-run",lint:"standard -v",test:"npm run build && standard && esbuild --bundle test/index.js | tape-run","test:open":"npm run build && esbuild --bundle test/index.js | tape-run --browser chrome --keep-open",prepare:"./scripts/build.js",build:"./scripts/build.js && npm run minify:esm && npm run minify:cjs","minify:esm":"esbuild index.esm.js --keep-names --minify --outfile=dist/tonic.min.esm.js","minify:cjs":"esbuild index.js --keep-names --minify --outfile=dist/tonic.min.js",pub:"npm pub && npm publish --registry https://npm.pkg.github.com"},main:"index.js",author:"socketsupply",license:"MIT",devDependencies:{benchmark:"^2.1.4",esbuild:"^0.8.36",standard:"14.3.1","tape-run":"^8.0.0",tapzero:"0.2.2",uuid:"3.3.3"},standard:{ignore:["dist/*","test/fixtures/*"]},directories:{test:"test"},repository:{type:"git",url:"git+https://github.com/socketsupply/tonic.git"},bugs:{url:"https://github.com/socketsupply/tonic/issues"},homepage:"https://tonicframework.dev",dependencies:{}}});var g=b((O,c)=>{"use strict";var a=class{constructor(e,t,n){this.isTonicTemplate=!0,this.unsafe=n,this.rawText=e,this.templateStrings=t}valueOf(){return this.rawText}toString(){return this.rawText}},s=class extends window.HTMLElement{constructor(){super();let e=s._states[super.id];delete s._states[super.id],this._state=e||{},this.preventRenderOnReconnect=!1,this.props={},this.elements=[...this.children],this.elements.__children__=!0,this.nodes=[...this.childNodes],this.nodes.__children__=!0,this._events()}static _createId(){return`tonic${s._index++}`}static _splitName(e){return e.match(/[A-Z][a-z0-9]*/g).join("-")}static _normalizeAttrs(e,t={}){return[...e].forEach(n=>t[n.name]=n.value),t}_checkId(){let e=super.id;if(!e){let t=this.outerHTML.replace(this.innerHTML,"...");throw new Error(`Component: ${t} has no id`)}return e}get state(){return this._checkId(),this._state}set state(e){this._state=(this._checkId(),e)}_events(){let e=Object.getOwnPropertyNames(window.HTMLElement.prototype);for(let t of this._props)e.indexOf("on"+t)!==-1&&this.addEventListener(t,this)}_prop(e){let t=this._id,n=`__${t}__${s._createId()}__`;return s._data[t]=s._data[t]||{},s._data[t][n]=e,n}_placehold(e){let t=this._id,n=`placehold:${t}:${s._createId()}__`;return s._children[t]=s._children[t]||{},s._children[t][n]=e,n}static match(e,t){return e.matches||(e=e.parentElement),e.matches(t)?e:e.closest(t)}static getPropertyNames(e){let t=[];for(;e&&e!==s.prototype;)t.push(...Object.getOwnPropertyNames(e)),e=Object.getPrototypeOf(e);return t}static add(e,t){if(!(t||e.name&&e.name.length>1))throw Error("Mangling. https://bit.ly/2TkJ6zP");if(t||(t=s._splitName(e.name).toLowerCase()),!s.ssr&&window.customElements.get(t))throw new Error(`Cannot Tonic.add(${e.name}, '${t}') twice`);if(!e.prototype||!e.prototype.isTonicComponent){let r={[e.name]:class extends s{}}[e.name];r.prototype.render=e,e=r}return e.prototype._props=s.getPropertyNames(e.prototype),s._reg[t]=e,s._tags=Object.keys(s._reg).join(),window.customElements.define(t,e),typeof e.stylesheet=="function"&&s.registerStyles(e.stylesheet),e}static registerStyles(e){if(s._stylesheetRegistry.includes(e))return;s._stylesheetRegistry.push(e);let t=document.createElement("style");s.nonce&&t.setAttribute("nonce",s.nonce),t.appendChild(document.createTextNode(e())),document.head&&document.head.appendChild(t)}static escape(e){return e.replace(s.ESC,t=>s.MAP[t])}static unsafeRawString(e,t){return new a(e,t,!0)}dispatch(e,t=null){let n={bubbles:!0,detail:t};this.dispatchEvent(new window.CustomEvent(e,n))}html(e,...t){let n=i=>{if(i&&i.__children__)return this._placehold(i);if(i&&i.isTonicTemplate)return i.rawText;switch(Object.prototype.toString.call(i)){case"[object HTMLCollection]":case"[object NodeList]":return this._placehold([...i]);case"[object Array]":return i.every(d=>d.isTonicTemplate&&!d.unsafe)?new a(i.join(`
`),null,!1):this._prop(i);case"[object Object]":case"[object Function]":return this._prop(i);case"[object NamedNodeMap]":return this._prop(s._normalizeAttrs(i));case"[object Number]":return`${i}__float`;case"[object String]":return s.escape(i);case"[object Boolean]":return`${i}__boolean`;case"[object Null]":return`${i}__null`;case"[object HTMLElement]":return this._placehold([i])}return typeof i=="object"&&i&&i.nodeType===1&&typeof i.cloneNode=="function"?this._placehold([i]):i},r=[];for(let i=0;i<e.length-1;i++)r.push(e[i],n(t[i]));r.push(e[e.length-1]);let o=r.join("").replace(s.SPREAD,(i,d)=>{let h=s._data[d.split("__")[1]][d];return Object.entries(h).map(([j,p])=>{let m=j.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return p===!0?m:p?`${m}="${s.escape(String(p))}"`:""}).filter(Boolean).join(" ")});return new a(o,e,!1)}scheduleReRender(e){return this.pendingReRender?this.pendingReRender:(this.pendingReRender=new Promise(t=>setTimeout(()=>{if(!this.isInDocument(this.shadowRoot||this))return;let n=this._set(this.shadowRoot||this,this.render);if(this.pendingReRender=null,n&&n.then)return n.then(()=>{this.updated&&this.updated(e),t()});this.updated&&this.updated(e),t()},0)),this.pendingReRender)}reRender(e=this.props){let t={...this.props};return this.props=typeof e=="function"?e(t):e,this.scheduleReRender(t)}handleEvent(e){this[e.type](e)}_drainIterator(e,t){return t.next().then(n=>{if(this._set(e,null,n.value),!n.done)return this._drainIterator(e,t)})}_set(e,t,n=""){this.willRender&&this.willRender();for(let r of e.querySelectorAll(s._tags)){if(!r.isTonicComponent)continue;let o=r.getAttribute("id");!o||!s._refIds.includes(o)||(s._states[o]=r.state)}if(t instanceof s.AsyncFunction)return t.call(this,this.html,this.props).then(r=>this._apply(e,r));if(t instanceof s.AsyncFunctionGenerator)return this._drainIterator(e,t.call(this));t===null?this._apply(e,n):t instanceof Function&&this._apply(e,t.call(this,this.html,this.props)||"")}_apply(e,t){if(t&&t.isTonicTemplate?t=t.rawText:typeof t=="string"&&(t=s.escape(t)),typeof t=="string"){if(this.stylesheet&&(t=`<style nonce=${s.nonce||""}>${this.stylesheet()}</style>${t}`),e.innerHTML=t,this.styles){let o=this.styles();for(let i of e.querySelectorAll("[styles]"))for(let d of i.getAttribute("styles").split(/\s+/))Object.assign(i.style,o[d.trim()])}let n=s._children[this._id]||{},r=(o,i)=>{if(o.nodeType===3){let h=o.textContent.trim();n[h]&&i(o,n[h],h)}let d=o.childNodes;if(!!d)for(let h=0;h<d.length;h++)r(d[h],i)};r(e,(o,i,d)=>{for(let h of i)o.parentNode.insertBefore(h,o);delete s._children[this._id][d],o.parentNode.removeChild(o)})}else e.innerHTML="",e.appendChild(t.cloneNode(!0))}connectedCallback(){this.root=this.shadowRoot||this,super.id&&!s._refIds.includes(super.id)&&s._refIds.push(super.id);let e=t=>t.replace(/-(.)/g,(n,r)=>r.toUpperCase());for(let{name:t,value:n}of this.attributes){let r=e(t),o=this.props[r]=n;if(/__\w+__\w+__/.test(o)){let{1:i}=o.split("__");this.props[r]=s._data[i][o]}else if(/\d+__float/.test(o))this.props[r]=parseFloat(o,10);else if(o==="null__null")this.props[r]=null;else if(/\w+__boolean/.test(o))this.props[r]=o.includes("true");else if(/placehold:\w+:\w+__/.test(o)){let{1:i}=o.split(":");this.props[r]=s._children[i][o][0]}}if(this.props=Object.assign(this.defaults?this.defaults():{},this.props),this._id=this._id||s._createId(),this.willConnect&&this.willConnect(),!!this.isInDocument(this.root)){if(!this.preventRenderOnReconnect){this._source?this.innerHTML=this._source:this._source=this.innerHTML;let t=this._set(this.root,this.render);if(t&&t.then)return t.then(()=>this.connected&&this.connected())}this.connected&&this.connected()}}isInDocument(e){let t=e.getRootNode();return t===document||t.toString()==="[object ShadowRoot]"}disconnectedCallback(){this.disconnected&&this.disconnected(),delete s._data[this._id],delete s._children[this._id]}};s.prototype.isTonicComponent=!0;Object.assign(s,{_tags:"",_refIds:[],_data:{},_states:{},_children:{},_reg:{},_stylesheetRegistry:[],_index:0,version:typeof y<"u"?w().version:null,SPREAD:/\.\.\.\s?(__\w+__\w+__)/g,ESC:/["&'<>`/]/g,AsyncFunctionGenerator:async function*(){}.constructor,AsyncFunction:async function(){}.constructor,MAP:{'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;","/":"&#x2F;"}});typeof c=="object"&&(c.exports=s)});var f=$(g()),u=class extends f.default{constructor(){super(),this.state={hello:"world"}}hello(e){this.state.hello=e,this.reRender()}async render(){return this.html`<div>
            <p>Hello, ${this.state.hello}</p>
        </div>`}};f.default.add(u);})();
